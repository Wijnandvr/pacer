<!DOCTYPE html>
<html lang="en">
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- <link href='//fonts.googleapis.com/css?family=Montserrat:700,400' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Merriweather:400,400italic,700,700italic' rel='stylesheet' type='text/css'> -->
     <link rel="stylesheet" href="/pacer-doc/css/syntax.css"  type='text/css'>
     <link rel="stylesheet" href="/pacer-doc/css/font-awesome.min.css">
     <link rel="stylesheet" href="/pacer-doc/css/bootstrap.min.css">
     <link rel="stylesheet" href="/pacer-doc/css/modern-business.css">
    <link rel="stylesheet" href="/pacer-doc/css/lavish-bootstrap.css"  type='text/css'>
    <link rel="canonical" href="https://github.com/tomjohnson1492/pacer-doc/routes/">
    <link rel="stylesheet" href="/pacer-doc/css/customstyles.css"  type='text/css'>
     <link rel="stylesheet" href="/pacer-doc/css/projectstyles.css"  type='text/css'>
    <link rel="canonical" href="https://github.com/tomjohnson1492/pacer-doc/routes/">
  <link rel="alternate" type="application/rss+xml" title="Pacer Docs" href="https://github.com/tomjohnson1492/pacer-doc/feed.xml" />
    <script src="/pacer-doc/js/jquery.min.js"></script>
    <script src="/pacer-doc/js/jquery.cookie.min.js"></script>
    <script src="/pacer-doc/js/jquery.navgoco.min.js"></script>
    <script src="/pacer-doc/js/bootstrap.min.js"></script>
    <script src="/pacer-doc/js/toc.js"></script>
    <script src="/pacer-doc/js/customscripts.js"></script>
    <script src="/pacer-doc/js/projectscripts.js"></script>
       <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <title>Routes | Pacer Docs</title>
     <meta name="description" content="A theme based on Jekyll designed for technical writers creating help systems. Feel free to clone, fork, and otherwise use. It's all open source and free to implement.  Please consider contributing back any innovations you make so that others can benefit.
">
 

 

  </head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                  <a class="navbar-brand homeLink fa fa-home" href="/pacer-doc/"><span class="projectHome"> &nbsp;Pacer Docs</span></a>

                 
            </div>
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">

<!-- entries without drop-downs appear here -->
  
  

  
  <li><a href="https://github.com/pangloss/pacer/" target="_blank">Github Repo</a></li>
  
     
    


<!-- entries with drop-downs appear here -->


<li>
<!-- start search -->
   <div id="search-demo-container">
      <input type="text" id="search-input" placeholder="search...">
      <ul id="results-container"></ul>
    </div>

    
    <script src="/pacer-doc/js/jekyll-search.js" type="text/javascript"></script>
    
    
    <script type="text/javascript">
      SimpleJekyllSearch.init({
        searchInput: document.getElementById('search-input'),
        resultsContainer: document.getElementById('results-container'),
        dataSource: '/pacer-doc/search.json',        
        searchResultTemplate: '<li><a href="{url}" title="Routes">{title}</a></li>',
        noResultsText: 'No results found.',
        limit: 10,
        fuzzy: true,
      })
    </script>
    <!-- end search -->
 </li>



        </div>

        <!-- /.container -->
    </nav>


    <!-- Page Content -->
    <div class="container">
    <div class="col-lg-12">&nbsp;</div>





 <!-- Content Row -->
        <div class="row">
            <!-- Sidebar Column -->
            <div class="col-md-3">

<script>
$(document).ready(function() {
    // Initialize navgoco with default options
    $("#mysidebar").navgoco({
        caretHtml: '',
        accordion: true,
        openClass: 'active', // open
        save: true,
        cookie: {
            name: 'navgoco',
            expires: false,
            path: '/'
        },
        slide: {
            duration: 400,
            easing: 'swing'
        }
    });

    $("#collapseAll").click(function(e) {
        e.preventDefault();
        $("#mysidebar").navgoco('toggle', false);
    });

    $("#expandAll").click(function(e) {
        e.preventDefault();
        $("#mysidebar").navgoco('toggle', true);
    });
});

</script>
  
<!-- note that the data file for your project needs to be specified in the code below. Instead of site.data.jekyll, use the data file corresponding to your project (create one if it doesn't already exist). -->

<ul id="mysidebar" class="nav">


  
  
    <li><a href="#">Introduction</a>
    <ul>
    
    
      
      <li><a href="/pacer-doc/intro/">What is Pacer?</a></li>
    
     
    
    
      
      <li><a href="/pacer-doc/install/">Installation</a></li>
    
     
    
    
      
      <li><a href="/pacer-doc/quick_start/">Quick Start</a></li>
    
     
    
    
      
      <li><a href="/pacer-doc/suppoted_graph_databases/">Supported Databases</a></li>
    
     
    
    
      
      <li><a href="/pacer-doc/contributing/">Contributing to Pacer</a></li>
    
     
    
    </ul>
    </li>
  
    <li><a href="#">Fundamentals</a>
    <ul>
    
    
      
      <li><a href="/pacer-doc/pacer-extensions/">Extensions</a></li>
    
     
    
    
      
      <li class="active"><a href="/pacer-doc/routes/" class="active">Routes</a></li>
    
     
    
    </ul>
    </li>
  



</div>




            <!-- Content Column -->
            <div class="col-md-9">

                <div class="post-header">
  <h1 class="post-title-main">Routes</h1>
</div>
<div class="post-content">

<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>


<div id="toc"></div>


<p>Pacer is all about graph traversals. To traverse the graph with Pacer, you create a <strong>Route</strong>.</p>

<h2 id="what-is-a-route?">What is a route?</h2>

<p>A route is a <strong>collection</strong> of items (e.g. vertices or edges) that is <strong>composable</strong>, <strong>lazily-loaded</strong> and <strong>reusable</strong>:</p>

<ul>
<li>Routes implement Ruby&#39;s <a href="http://ruby-doc.org/core-1.9.3/Enumerable.html">Enumerable</a> module (with certain exceptions).</li>
<li>We define routes by composing them with one another.</li>
<li>When we build a route, no work is done on the graph until you execute it. </li>
<li>We can execute a route repeatedly.</li>
</ul>

<p><br /><br /></p>

<p>Alternatively, you can think of a route as a pipe, with a stream of items (e.g. vertices or edges) going into it, and a (possibly different) stream of items coming out of it.<br>
In fact, under the hood, Pacer routes are implemented using <a href="https://github.com/tinkerpop/pipes/wiki">Pipes</a>.</p>

<hr>

<p>For example, consider the following query: <em>Find all flights, with 1 connection, from NYC to LA.</em></p>

<p>In Pacer, this query will translate into something that looks like the following route:</p>

<p><br /></p>

<p><img src="/pacer-doc/images/Routes2.png" alt="Routes Example"></p>

<p><br /></p>

<p>And the code that creates (and executes) this route will look like this:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="n">g</span><span class="o">.</span><span class="n">v</span><span class="p">(</span><span class="ss">city</span><span class="p">:</span> <span class="s1">&#39;NYC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">out_e</span><span class="o">.</span><span class="n">in_v</span><span class="o">.</span><span class="n">out_e</span><span class="o">.</span><span class="n">in_v</span><span class="p">(</span><span class="ss">city</span><span class="p">:</span> <span class="s1">&#39;LA&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">paths</span>
</code></pre></div>
<p>In the rest of this section, we will go through the different ways you can use routes.</p>

<h2 id="starting-a-traversal">Starting A Traversal</h2>

<p>Every traversal needs to start somewhere in the graph. 
This starting point can be a vertex, edge, or a collection (i.e. a route) of such elements.</p>

<p>If <code>g</code> refers to a graph object, here are some ways to get a starting point:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Single vertex</span>
<span class="n">g</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">first</span>
<span class="c1"># Single vertex by id</span>
<span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">some_vertex_id</span><span class="p">)</span>

<span class="c1"># Single edge</span>
<span class="n">g</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="n">first</span>
<span class="c1"># Single edge by id</span>
<span class="n">g</span><span class="o">.</span><span class="n">edge</span><span class="p">(</span><span class="n">some_edge_id</span><span class="p">)</span>

<span class="c1"># A route (of max&#39; 10) vertices</span>
<span class="n">g</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># A route (of max&#39; 10) edges</span>
<span class="n">g</span><span class="o">.</span><span class="n">e</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</code></pre></div>
<h2 id="basics-traversal">Basics Traversal</h2>

<p>If our starting point, <code>v</code>, happens to be a vertex (or a vertex route), we can get its edges:</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Outgoing edges</span>
<span class="n">v</span><span class="o">.</span><span class="n">out_e</span>
<span class="c1"># Incoming edges</span>
<span class="n">v</span><span class="o">.</span><span class="n">in_e</span>
<span class="c1"># Both, incoming and outgoing, edges</span>
<span class="n">v</span><span class="o">.</span><span class="n">both_e</span>
</code></pre></div>
<p>Similarly, if <code>e</code> is an edge (or an edge route), we can get its vertices.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># The &quot;source&quot; vertex</span>
<span class="n">e</span><span class="o">.</span><span class="n">out_v</span>
<span class="c1"># The &quot;destination&quot; vertex</span>
<span class="n">e</span><span class="o">.</span><span class="n">in_v</span>
<span class="c1"># Both, &quot;source&quot; and &quot;destination&quot;, vertices</span>
<span class="n">e</span><span class="o">.</span><span class="n">both_v</span>
</code></pre></div>
<p><span class="label label-info">Terminology:</span> We say that an edge goes from its <em>out vertex</em> to its <em>in vertex</em> (or, in ascii, <code>out_v --e--&gt; in_v</code>).</p>

<p>Combining the basic traversals above, we can get the outgoing neighbours of a vertex (or a route of vertices), <code>v</code>.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Follow outgoing edges</span>
<span class="n">v</span><span class="o">.</span><span class="n">out_e</span><span class="o">.</span><span class="n">in_v</span>
</code></pre></div>
<p>As well as its incoming neighbours.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Follow incoming edges</span>
<span class="n">v</span><span class="o">.</span><span class="n">in_e</span><span class="o">.</span><span class="n">out_v</span>
</code></pre></div>
<p>What about all neighbours?
TODO: Add the short forms (with the caveat).</p>

<h2 id="basics-filtering">Basics Filtering</h2>

<p>Both, vertex and edge, routes can be filtered based on properties value(s).
Edge routes can also be filtered by edge label.</p>

<p>For example, we can define the following routes in a social network graph.</p>
<div class="highlight"><pre><code class="language-ruby" data-lang="ruby"><span class="c1"># Find users by name</span>
<span class="n">graph</span><span class="o">.</span><span class="n">v</span><span class="p">(</span><span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="nb">name</span><span class="p">:</span> <span class="s1">&#39;Bob&#39;</span><span class="p">)</span>

<span class="c1"># Find users that Bob follows</span>
<span class="n">graph</span><span class="o">.</span><span class="n">v</span><span class="p">(</span><span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="nb">name</span><span class="p">:</span> <span class="s1">&#39;Bob&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">out_e</span><span class="p">(</span><span class="ss">:follows</span><span class="p">)</span><span class="o">.</span><span class="n">in_v</span><span class="p">(</span><span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;user&#39;</span><span class="p">)</span>

<span class="c1"># Find followers of users that Bob follows</span>
<span class="n">graph</span><span class="o">.</span><span class="n">v</span><span class="p">(</span><span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="nb">name</span><span class="p">:</span> <span class="s1">&#39;Bob&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">out_e</span><span class="p">(</span><span class="ss">:follows</span><span class="p">)</span><span class="o">.</span><span class="n">in_v</span><span class="p">(</span><span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;user&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">in_e</span><span class="p">(</span><span class="ss">:follows</span><span class="p">)</span><span class="o">.</span><span class="n">out_v</span><span class="p">(</span><span class="ss">type</span><span class="p">:</span> <span class="s1">&#39;user&#39;</span><span class="p">)</span>
</code></pre></div>

</div>








            </div>
        </div>
        <!-- /.row -->

        <hr>

        <!-- Footer -->
        <footer>
            <div class="row">
                <div class="col-lg-12 footer">
                    















































 



                </div>
            </div>
        </footer>

    </div>    <!-- /.container -->



 
</body>




</html>

